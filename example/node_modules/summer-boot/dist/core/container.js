"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var a=arguments[e],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n};Object.defineProperty(exports,"__esModule",{value:!0});var decorate_1=require("./decorate"),ContainerMap=function(){function t(){this.controller=new Map,this.component=new Set,this.handler=new Set}return t.prototype.getAllValues=function(){for(var t=__spreadArrays(Array.from(this.component),Array.from(this.handler)),e=this.controller.values(),r=e.next();!r.done;)t.push(r.value),r=e.next();return t},t}(),Container=function(){function t(){this.container=new ContainerMap}return t.prototype.add=function(t,e){this.container.controller.set(t,e)},t.prototype.get=function(t,e){var r=this.container.controller.get(e+":"+t);if(r&&r.method===e)return r;for(var n=this.container.controller.entries(),o=n.next();!o.done;){var a=o.value[1];if(a&&a.method===e&&a.rules&&a.rules.test(t))return a;o=n.next()}return null},t.prototype.findAll=function(t){for(var e=this.container.getAllValues().entries(),r=e.next();!r.done;){if(t(r.value[0],r.value[1]))break;r=e.next()}},t.prototype.addService=function(t){this.container.component.add(t)},t.prototype.getByType=function(t){for(var e=this.container.component.entries(),r=e.next();!r.done;){var n=r.value[1];if(n.instance instanceof t)return n.instance;r=e.next()}return null},t.prototype.getByName=function(r){var n=null;return this.findAll(function(t,e){if(e.instance.constructor.name===r)return n=e.instance,!0}),n},t.prototype.getInterceptor=function(t){for(var e=[],r=0,n=Array.from(this.container.handler).filter(function(t){return t.type===decorate_1.MetaKey.INTERCEPTOR_HANDLER});r<n.length;r++){var o=n[r];o.rules&&!o.rules.test(t)||e.push(o)}return e},t.prototype.getErrorHandler=function(){return Array.from(this.container.handler).filter(function(t){return t.type===decorate_1.MetaKey.ERROR_HANDLER})},t.prototype.addInterceptor=function(t){this.container.handler.add(t)},t}();function getContainer(){var e=new Container,t=Object.keys(e.__proto__),r={};return t.forEach(function(t){return r[t]=e[t].bind(e)}),r}exports.default=getContainer();