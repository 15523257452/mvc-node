"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadSchedule=void 0;var __1=require("../.."),loader_1=require("../../util/loader"),container_1=require("../../core/container"),NodeSchedule=require("node-schedule"),pwd=process.cwd(),path=require("path"),fs=require("fs");function loadSchedule(){var e=path.resolve(pwd,__1.Config.getConfig().scheduleDir);fs.existsSync(e)&&loader_1.default.load(e).forEach(function(e){if(Reflect.hasMetadata(__1.MetaKey.SCHEDULE,e)){var r=Reflect.getMetadata(__1.MetaKey.SCHEDULE,e).rule,e=container_1.default.getByType(e)||new e;if("function"!=typeof e.run)throw new Error("Schedule task must implements run method");e.job=NodeSchedule.scheduleJob(r,e.run.bind(e))}})}exports.loadSchedule=loadSchedule;